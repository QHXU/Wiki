<!DOCTYPE html>
<meta charset="utf-8">
<title>Wiki</title>
<style>
@import url(./css/d3.parsets.css);
@import url(./css/manual.css);
</style>
<body>
<h1>Wiki</h1>
<p class="meta">Analysis of Wikipedia

<div class="container">

	<div class="flex-container">
		<nav class="nav">
			<h3 style = "text-align:right";> Dimensions </h3>
			<div id="option">
				<input  name="updateButton"
					type="button"
					value="Update"
					onclick="updateData()" />
			</div>
			<div id="vis_nav"></div>
		</nav>
		<article class="article">
			<div id="vis" ><noscript><img alt="Choose Dimension and click Update" src="parsets.png"></noscript></div>
		</article>
	</div>
 </div>

<script src="./js/d3.min.js"></script>
<script src="./js/d3.parsets.js"></script>
<script src="./js/highlight.min.js"></script>

<script>
var FirstLoad = true;
var Header_Names;
var Chart = d3.parsets();
var Partition = d3.layout.partition()
    .sort(null)
    .size([chart.width(), chart.height() * 5 / 4])
    .children(function(d) { return d.children ? d3.values(d.children) : null; })
    .value(function(d) { return d.count; });

var Selected_Dimensions = [];
var DataPath = ["wiki4HE"];

function LoadDimension(DataPath) 
	{
		Data_Path = "./data/"+DataPath+".csv";
		var nav_canvas = d3.csv(Data_Path, function(error, data) 
		{
			Header_Names = d3.keys(data[0]);
			Data_Source = data;
			var form = d3.select("#vis_nav").append("form");
			Labels = form.SelectAll("Label")
			.data(Header_Names)
			.enter()
			.append("div")
			.text(function(d) {return d;})
			.insert("input")
			.attr
			({
				type: "checkbox",
				class: "shape",
				name: function(d) {return d;},
				value: function(d, i) {return i;}
			});

		});
	}

	
function getCheckedBoxes(Box_Name) 
	{
  	 var Box = document.getElementsByClassName(Box_Name);
 	 var Checkedboxes = [];
 	 for (var i=0; i<Box.length; i++) 
		 {
    		 if (Box[i].checked) {Checkedboxes.push(Box[i]);}
 	 	 }
  	return Checkedboxes.length > 0 ? Checkedboxes : null;
	}

	
function updateData () 
	{
	if (FirstLoad)
		{
		FirstLoad = false;
		return null;
		}

	var Check_Check = getCheck_Check("shape");
	if (Check_Check == null) 
		{
		Check_Check = [];
		}
  	if (Check_Check.length<2) 
		{
		alert("Please select at least 2 dimensions!" );
		return null;
		}
	Selected_Dimensions = []
	for (var i=0; i<Check_Check.length; i++) 
		{
	 	if (Check_Check[i].checked) 
			{
			Selected_Dimensions.push(Check_Check[i].name);
			}
		}
	chart = d3.parsets().dimensions(Selected_Dimensions);
	d3.select("#parallelset01").remove();
	var vis = d3.select("#vis").append("svg")
		.attr("id","parallelset01")
		.attr("width", chart.width())
		.attr("height", chart.height());

	vis.datum(Data_Source).call(chart);
	}

function updateAll() 
	{
	updateData();
	}

loadDimension(DataPath[0]);
updateAll();

</script>
